{% extends "layout.html" %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='my_recommendations.css') }}">

<h2>Your Saved Recommendations</h2>

<!-- Tabs -->
<div class="tab-buttons">
  <button class="tab-button active" onclick="showTab('foodies')">🍽️ Restaurants</button>
  <button class="tab-button" onclick="showTab('prep')">🥗 Meals</button>
</div>

<!-- FoodiesRN Section -->
<div id="foodies" class="tab-content">
  <div class="card-section">
    <div class="section-header">
      <form method="POST" action="{{ url_for('clear_foodiesrn') }}">
        <button type="submit">Clear All</button>
      </form>
    </div>

    {% if foodiesrn_results %}
      <div class="card-container">
        {% for r in foodiesrn_results %}
          <div class="card">
          <img src="{{ r.image_url }}" alt="Restaurant Image" class="card-img"
          onerror="this.onerror=null;this.src='https://st4.depositphotos.com/14953852/24787/v/450/depositphotos_247872612-stock-illustration-no-image-available-icon-vector.jpg';">
            <strong>{{ r.name }}</strong><br>
            {{ r.location }}<br>
            ⭐ Rating: {{ r.rating }} | 💲Price: {{ r.price }}<br><br>
            <a href="{{ r.url }}" target="_blank">Yelp Link</a>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p>No restaurants saved yet.</p>
    {% endif %}
  </div>
</div>

<!-- PrepNGo Section -->
<div id="prep" class="tab-content" style="display: none;">
  <div class="card-section">
    <div class="section-header">
      <form method="POST" action="{{ url_for('clear_prepngo') }}">
        <button type="submit">Clear All</button>
      </form>
    </div>

    {% if prepngo_results %}
      <div class="card-container">
        {% for m in prepngo_results %}
          <div class="card">
            <strong>{{ m[0] }}</strong><br>
            💰 ${{ "%.2f"|format(m[1]) }}<br><br>
            {{ m[2] }}<br><br>
            <a href="{{ m[3] }}" target="_blank">View Recipe</a>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p>No meals saved yet.</p>
    {% endif %}
  </div>
</div>

<script>
  function showTab(tabId) {
    document.querySelectorAll('.tab-content').forEach(el => el.style.display = 'none');
    document.getElementById(tabId).style.display = 'block';

    document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
  }
</script>
{% endblock %}
