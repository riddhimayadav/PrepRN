{% extends "layout.html" %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='foodies.css') }}">
<div class="eatout-wrapper">
  <h2>Find Your Next Spot</h2>

  <form method="POST" class="eatout-form" onsubmit="showLoading()">
    <div class="input-group">
      <label><i class="fas fa-map-marker-alt"></i> Location:</label>
      <input name="location" placeholder="(e.g., Austin, TX)" required>
    </div>

    <div class="input-group">
      <label><i class="fas fa-utensils"></i> Food Type:</label>
      <select name="cuisine" required>
        <option>Thai</option>
        <option>Mexican</option>
        <option>Vegan</option>
        <option>American</option>
        <option>Chinese</option>
        <option>Barbeque</option>
        <option>Greek</option>
        <option>Indian</option>
        <option>Italian</option>
      </select>
    </div>

    <div class="input-group">
      <label><i class="fas fa-wallet"></i> Budget:</label>
      <select name="price" required>
        <option>$</option>
        <option>$$</option>
        <option>$$$</option>
        <option>$$$$</option>
      </select>
    </div>

    <div class="input-group">
      <label><i class="fas fa-heart"></i> Vibe / Mood:</label>
      <select name="vibe" required>
        <option>Cozy</option>
        <option>Trendy</option>
        <option>Romantic</option>
        <option>Casual</option>
      </select>
    </div>

    <button type="submit">Continue</button>
  </form>
  <div id="loading-msg" style="display:none; text-align:center; margin-top: 1em;">
  <p>üîç Generating your personalized recommendations...</p>
</div>
</div>

<script>
  function showLoading() {
    document.getElementById("loading-msg").style.display = "block";
  }
</script>

{% if results %}
<h3 id="recommendations">Top Recommendations:</h3>
<div class="recommendation-wrapper">
  {% for r in results %}
    <div class="recommendation">
      <img src="{{ r.image_url }}" alt="Restaurant Image"
         class="card-img"
         onerror="this.onerror=null;this.src='https://st4.depositphotos.com/14953852/24787/v/450/depositphotos_247872612-stock-illustration-no-image-available-icon-vector.jpg';">
      <h4>{{ r.name }} ‚Äì {{ r.location }}</h4>
      <p>Rating: {{ r.rating }} | Price: {{ r.price }}</p>
      <p>{{ r.blurb }}</p>
      <a href="{{ r.url }}" target="_blank">View on Yelp</a>
    </div>
  {% endfor %}
</div>
{% endif %}


<script>
  window.addEventListener('DOMContentLoaded', () => {
    const resultsExist = {{ 'true' if results else 'false' }};
    if (resultsExist) {
      const recSection = document.getElementById('recommendations');
      if (recSection) {
        recSection.scrollIntoView({ behavior: 'smooth' });
      }
    }
  });
</script>


{% endblock %}

